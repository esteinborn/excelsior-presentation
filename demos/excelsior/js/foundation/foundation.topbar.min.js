(function($,window){"use strict";Foundation.libs.topbar={name:"topbar",version:"4.1.7",settings:{index:0,stickyClass:"sticky",custom_back_text:!0,back_text:"Back",scrolltop:!0,init:!1},init:function(section,method,options){Foundation.inherit(this,"data_options");var self=this;return"object"==typeof method?$.extend(!0,this.settings,method):options!==undefined&&$.extend(!0,this.settings,options),"string"!=typeof method?($(".top-bar, [data-topbar]").each(function(){$.extend(!0,self.settings,self.data_options($(this))),self.settings.$w=$(window),self.settings.$topbar=$(this),self.settings.$section=self.settings.$topbar.find("section"),self.settings.$titlebar=self.settings.$topbar.children("ul").first(),self.settings.$topbar.data("index",0);var breakpoint=$("<div class='top-bar-js-breakpoint'/>").insertAfter(self.settings.$topbar);self.settings.breakPoint=breakpoint.width(),breakpoint.remove(),self.assemble(),self.settings.$topbar.parent().hasClass("fixed")&&$("body").css("padding-top",self.outerHeight(self.settings.$topbar))}),self.settings.init||this.events(),this.settings.init):this[method].call(this,options)},events:function(){var self=this,offst=this.outerHeight($(".top-bar, [data-topbar]"));$(this.scope).on("click.fndtn.topbar",".top-bar .toggle-topbar, [data-topbar] .toggle-topbar",function(e){var topbar=$(this).closest(".top-bar, [data-topbar]"),section=topbar.find("section, .section");topbar.children("ul").first(),topbar.data("height")||self.largestUL(),e.preventDefault(),self.breakpoint()&&topbar.toggleClass("expanded").css("min-height",""),topbar.hasClass("expanded")?topbar.parent().hasClass("fixed")&&(topbar.parent().removeClass("fixed"),topbar.addClass("fixed"),$("body").css("padding-top","0"),self.settings.scrolltop&&window.scrollTo(0,0)):(self.rtl?(section.css({right:"0%"}),section.find(">.name").css({right:"100%"})):(section.css({left:"0%"}),section.find(">.name").css({left:"100%"})),section.find("li.moved").removeClass("moved"),topbar.data("index",0),topbar.hasClass("fixed")&&(topbar.parent().addClass("fixed"),topbar.removeClass("fixed"),$("body").css("padding-top",offst)))}).on("click.fndtn.topbar",".top-bar .has-dropdown>a, [data-topbar] .has-dropdown>a",function(e){var topbar=$(this).closest(".top-bar, [data-topbar]"),section=topbar.find("section, .section"),titlebar=topbar.children("ul").first(),dropdownHeight=$(this).next(".dropdown").outerHeight();if((Modernizr.touch||self.breakpoint())&&e.preventDefault(),self.breakpoint()){var $this=$(this),$selectedLi=$this.closest("li");topbar.data("index",topbar.data("index")+1),$selectedLi.addClass("moved"),self.rtl?(section.css({right:-(100*topbar.data("index"))+"%"}),section.find(">.name").css({right:100*topbar.data("index")+"%"})):(section.css({left:-(100*topbar.data("index"))+"%"}),section.find(">.name").css({left:100*topbar.data("index")+"%"})),$(".top-bar, [data-topbar]").css("min-height",dropdownHeight),$this.siblings("ul").height(topbar.data("height")+self.outerHeight(titlebar,!0)),topbar.css("min-height",topbar.data("height")+2*self.outerHeight(titlebar,!0))}}),$(window).on("resize.fndtn.topbar",function(){self.breakpoint()||$(".top-bar, [data-topbar]").css("min-height","").removeClass("expanded")}.bind(this)),$(this.scope).on("click.fndtn",".top-bar .has-dropdown .back, [data-topbar] .has-dropdown .back",function(e){e.preventDefault();var $this=$(this),topbar=$this.closest(".top-bar, [data-topbar]"),section=topbar.find("section, .section"),$movedLi=$this.closest("li.moved");$movedLi.parent(),topbar.data("index",topbar.data("index")-1),self.rtl?(section.css({right:-(100*topbar.data("index"))+"%"}),section.find(">.name").css({right:100*topbar.data("index")+"%"})):(section.css({left:-(100*topbar.data("index"))+"%"}),section.find(">.name").css({left:100*topbar.data("index")+"%"})),0===topbar.data("index")&&topbar.css("min-height",0),setTimeout(function(){$movedLi.removeClass("moved")},300)})},breakpoint:function(){return $(window).width()<=this.settings.breakPoint||$("html").hasClass("lt-ie9")},assemble:function(){var self=this;this.settings.$section.detach(),this.settings.$section.find(".has-dropdown>a").each(function(){var $link=$(this),$dropdown=$link.siblings(".dropdown"),$titleLi=$('<li class="title back js-generated"><h5><a href="#"></a></h5></li>');1==self.settings.custom_back_text?$titleLi.find("h5>a").html("&laquo; "+self.settings.back_text):$titleLi.find("h5>a").html("&laquo; "+$link.html()),$dropdown.prepend($titleLi)}),this.settings.$section.appendTo(this.settings.$topbar),this.sticky()},largestUL:function(){var uls=this.settings.$topbar.find("section ul ul"),largest=uls.first(),total=0,self=this;uls.each(function(){$(this).children("li").length>largest.children("li").length&&(largest=$(this))}),largest.children("li").each(function(){total+=self.outerHeight($(this),!0)}),this.settings.$topbar.data("height",total)},sticky:function(){var klass="."+this.settings.stickyClass;if($(klass).length>0){var distance=$(klass).length?$(klass).offset().top:0,$window=$(window),offst=this.outerHeight($(".top-bar"));$window.scroll(function(){$window.scrollTop()>=distance?($(klass).addClass("fixed"),$("body").css("padding-top",offst)):distance>$window.scrollTop()&&($(klass).removeClass("fixed"),$("body").css("padding-top","0"))})}},off:function(){$(this.scope).off(".fndtn.topbar"),$(window).off(".fndtn.topbar")}}})(Foundation.zj,this,this.document);