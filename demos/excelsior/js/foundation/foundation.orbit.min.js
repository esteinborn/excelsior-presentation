(function($,window,document,undefined){"use strict";Foundation.libs=Foundation.libs||{},Foundation.libs.orbit={name:"orbit",version:"4.1.0",settings:{timer_speed:1e4,animation_speed:500,bullets:!0,stack_on_small:!0,navigation_arrows:!0,slide_number:!0,container_class:"orbit-container",stack_on_small_class:"orbit-stack-on-small",next_class:"orbit-next",prev_class:"orbit-prev",timer_container_class:"orbit-timer",timer_paused_class:"paused",timer_progress_class:"orbit-progress",slides_container_class:"orbit-slides-container",bullets_container_class:"orbit-bullets",bullets_active_class:"active",slide_number_class:"orbit-slide-number",caption_class:"orbit-caption",active_slide_class:"active",orbit_transition_class:"orbit-transitioning"},init:function(scope,method){var self=this;Foundation.inherit(self,"data_options"),"object"==typeof method&&$.extend(!0,self.settings,method),$("[data-orbit]",scope).each(function(idx,el){var scoped_self=$.extend(!0,{},self);scoped_self._init(idx,el)})},_container_html:function(){var self=this;return'<div class="'+self.settings.container_class+'"></div>'},_bullets_container_html:function($slides){var self=this,$list=$('<ol class="'+self.settings.bullets_container_class+'"></ol>');return $slides.each(function(idx){var $item=$('<li data-orbit-slide-number="'+(idx+1)+'" class=""></li>');0===idx&&$item.addClass(self.settings.bullets_active_class),$list.append($item)}),$list},_slide_number_html:function(slide_number,total_slides){var self=this,$container=$('<div class="'+self.settings.slide_number_class+'"></div>');return $container.append("<span>"+slide_number+"</span> of <span>"+total_slides+"</span>"),$container},_timer_html:function(){var self=this;return"number"==typeof self.settings.timer_speed&&self.settings.timer_speed>0?'<div class="'+self.settings.timer_container_class+'"><span></span><div class="'+self.settings.timer_progress_class+'"></div></div>':""},_next_html:function(){var self=this;return'<a href="#" class="'+self.settings.next_class+'">Next <span></span></a>'},_prev_html:function(){var self=this;return'<a href="#" class="'+self.settings.prev_class+'">Prev <span></span></a>'},_init:function(idx,slider){var self=this,$slides_container=$(slider),$container=$slides_container.wrap(self._container_html()).parent(),$slides=$slides_container.children();$.extend(!0,self.settings,self.data_options($slides_container)),self.settings.navigation_arrows&&($container.append(self._prev_html()),$container.append(self._next_html())),$slides_container.addClass(self.settings.slides_container_class),self.settings.stack_on_small&&$container.addClass(self.settings.stack_on_small_class),self.settings.slide_number&&$container.append(self._slide_number_html(1,$slides.length)),$container.append(self._timer_html()),self.settings.bullets&&$container.after(self._bullets_container_html($slides)),$slides_container.append($slides.first().clone().attr("data-orbit-slide","")),$slides_container.prepend($slides.last().clone().attr("data-orbit-slide","")),$slides_container.css(Foundation.rtl?"marginRight":"marginLeft","-100%"),$slides.first().addClass(self.settings.active_slide_class),self._init_events($slides_container),self._init_dimensions($slides_container),self._start_timer($slides_container)},_init_events:function($slides_container){var self=this,$container=$slides_container.parent();$(window).on("load.fndtn.orbit",function(){$slides_container.height(""),$slides_container.height($slides_container.height($container.height())),$slides_container.trigger("orbit:ready")}).on("resize.fndtn.orbit",function(){$slides_container.height(""),$slides_container.height($slides_container.height($container.height()))}),$(document).on("click.fndtn.orbit","[data-orbit-link]",function(e){e.preventDefault();var id=$(e.currentTarget).attr("data-orbit-link"),$slide=$slides_container.find("[data-orbit-slide="+id+"]").first();1===$slide.length&&(self._reset_timer($slides_container,!0),self._goto($slides_container,$slide.index(),function(){}))}),$container.siblings("."+self.settings.bullets_container_class).on("click.fndtn.orbit","[data-orbit-slide-number]",function(e){e.preventDefault(),self._reset_timer($slides_container,!0),self._goto($slides_container,$(e.currentTarget).data("orbit-slide-number"),function(){})}),$container.on("orbit:after-slide-change.fndtn.orbit",function(e,orbit){var $slide_number=$container.find("."+self.settings.slide_number_class);1===$slide_number.length&&$slide_number.replaceWith(self._slide_number_html(orbit.slide_number,orbit.total_slides))}).on("orbit:next-slide.fndtn.orbit click.fndtn.orbit","."+self.settings.next_class,function(e){e.preventDefault(),self._reset_timer($slides_container,!0),self._goto($slides_container,"next",function(){})}).on("orbit:prev-slide.fndtn.orbit click.fndtn.orbit","."+self.settings.prev_class,function(e){e.preventDefault(),self._reset_timer($slides_container,!0),self._goto($slides_container,"prev",function(){})}).on("orbit:toggle-play-pause.fndtn.orbit click.fndtn.orbit touchstart.fndtn.orbit","."+self.settings.timer_container_class,function(e){e.preventDefault();var $timer=$(e.currentTarget).toggleClass(self.settings.timer_paused_class),$slides_container=$timer.closest("."+self.settings.container_class).find("."+self.settings.slides_container_class);$timer.hasClass(self.settings.timer_paused_class)?self._stop_timer($slides_container):self._start_timer($slides_container)}).on("touchstart.fndtn.orbit",function(e){e.touches||(e=e.originalEvent);var data={start_page_x:e.touches[0].pageX,start_page_y:e.touches[0].pageY,start_time:(new Date).getTime(),delta_x:0,is_scrolling:undefined};$container.data("swipe-transition",data),e.stopPropagation()}).on("touchmove.fndtn.orbit",function(e){if(e.touches||(e=e.originalEvent),!(e.touches.length>1||e.scale&&1!==e.scale)){var data=$container.data("swipe-transition");if(data===undefined&&(data={}),data.delta_x=e.touches[0].pageX-data.start_page_x,data.is_scrolling===undefined&&(data.is_scrolling=!!(data.is_scrolling||Math.abs(data.delta_x)<Math.abs(e.touches[0].pageY-data.start_page_y))),!data.is_scrolling&&!data.active){e.preventDefault(),self._stop_timer($slides_container);var direction=0>data.delta_x?"next":"prev";data.active=!0,self._goto($slides_container,direction,function(){})}}}).on("touchend.fndtn.orbit",function(e){$container.data("swipe-transition",{}),e.stopPropagation()})},_init_dimensions:function($slides_container){var $container=$slides_container.parent(),$slides=$slides_container.children();$slides_container.css("width",100*$slides.length+"%"),$slides.css("width",100/$slides.length+"%"),$slides_container.height($container.height()),$slides_container.css("width",100*$slides.length+"%")},_start_timer:function($slides_container){var self=this,$container=$slides_container.parent(),callback=function(){self._reset_timer($slides_container,!1),self._goto($slides_container,"next",function(){self._start_timer($slides_container)})},$timer=$container.find("."+self.settings.timer_container_class),$progress=$timer.find("."+self.settings.timer_progress_class),progress_pct=$progress.width()/$timer.width(),delay=self.settings.timer_speed-progress_pct*self.settings.timer_speed;$progress.animate({width:"100%"},delay,"linear",callback),$slides_container.trigger("orbit:timer-started")},_stop_timer:function($slides_container){var self=this,$container=$slides_container.parent(),$timer=$container.find("."+self.settings.timer_container_class),$progress=$timer.find("."+self.settings.timer_progress_class),progress_pct=$progress.width()/$timer.width();self._rebuild_timer($container,100*progress_pct+"%"),$slides_container.trigger("orbit:timer-stopped"),$timer=$container.find("."+self.settings.timer_container_class),$timer.addClass(self.settings.timer_paused_class)},_reset_timer:function($slides_container,is_paused){var self=this,$container=$slides_container.parent();if(self._rebuild_timer($container,"0%"),"boolean"==typeof is_paused&&is_paused){var $timer=$container.find("."+self.settings.timer_container_class);$timer.addClass(self.settings.timer_paused_class)}},_rebuild_timer:function($container,width_pct){var self=this,$timer=$container.find("."+self.settings.timer_container_class),$new_timer=$(self._timer_html()),$new_timer_progress=$new_timer.find("."+self.settings.timer_progress_class);if("function"==typeof Zepto)$timer.remove(),$container.append($new_timer),$new_timer_progress.css("width",width_pct);else if("function"==typeof jQuery){var $progress=$timer.find("."+self.settings.timer_progress_class);$progress.css("width",width_pct),$progress.stop()}},_goto:function($slides_container,index_or_direction,callback){var self=this,$container=$slides_container.parent(),$slides=$slides_container.children(),$active_slide=$slides_container.find("."+self.settings.active_slide_class),active_index=$active_slide.index(),margin_position=Foundation.rtl?"marginRight":"marginLeft";if($container.hasClass(self.settings.orbit_transition_class))return!1;"prev"===index_or_direction?0===active_index?active_index=$slides.length-1:active_index--:"next"===index_or_direction?active_index=(active_index+1)%$slides.length:"number"==typeof index_or_direction&&(active_index=index_or_direction%$slides.length),active_index===$slides.length-1&&"next"===index_or_direction?($slides_container.css(margin_position,"0%"),active_index=1):0===active_index&&"prev"===index_or_direction&&($slides_container.css(margin_position,"-"+100*($slides.length-1)+"%"),active_index=$slides.length-2),$container.addClass(self.settings.orbit_transition_class),$active_slide.removeClass(self.settings.active_slide_class),$($slides[active_index]).addClass(self.settings.active_slide_class);var $bullets=$container.siblings("."+self.settings.bullets_container_class);1===$bullets.length&&($bullets.children().removeClass(self.settings.bullets_active_class),$($bullets.children()[active_index-1]).addClass(self.settings.bullets_active_class));var new_margin_left="-"+100*active_index+"%";if($slides_container.trigger("orbit:before-slide-change"),$slides_container.css(margin_position)===new_margin_left)$container.removeClass(self.settings.orbit_transition_class),$slides_container.trigger("orbit:after-slide-change",[{slide_number:active_index,total_slides:$slides_container.children().length-2}]),callback();else{var properties={};properties[margin_position]=new_margin_left,$slides_container.animate(properties,self.settings.animation_speed,"linear",function(){$container.removeClass(self.settings.orbit_transition_class),$slides_container.trigger("orbit:after-slide-change",[{slide_number:active_index,total_slides:$slides_container.children().length-2}]),callback()})}}}})(Foundation.zj,this,this.document);