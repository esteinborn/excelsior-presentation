(function($,window){"use strict";Foundation.libs.reveal={name:"reveal",version:"4.1.3",locked:!1,settings:{animation:"fadeAndPop",animationSpeed:250,closeOnBackgroundClick:!0,dismissModalClass:"close-reveal-modal",bgClass:"reveal-modal-bg",open:function(){},opened:function(){},close:function(){},closed:function(){},bg:$(".reveal-modal-bg"),css:{open:{opacity:0,visibility:"visible",display:"block"},close:{opacity:1,visibility:"hidden",display:"none"}}},init:function(scope,method,options){return Foundation.inherit(this,"data_options delay"),"object"==typeof method?$.extend(!0,this.settings,method):options!==undefined&&$.extend(!0,this.settings,options),"string"!=typeof method?(this.events(),this.settings.init):this[method].call(this,options)},events:function(){var self=this;return $(this.scope).off(".fndtn.reveal").on("click.fndtn.reveal","[data-reveal-id]",function(e){e.preventDefault(),self.locked||(self.locked=!0,self.open.call(self,$(this)))}).on("click.fndtn.reveal touchend.click.fndtn.reveal",this.close_targets(),function(e){if(e.preventDefault(),!self.locked){var settings=$.extend({},self.settings,self.data_options($(".reveal-modal.open")));if($(e.target)[0]===$("."+settings.bgClass)[0]&&!settings.closeOnBackgroundClick)return;self.locked=!0,self.close.call(self,$(this).closest(".reveal-modal"))}}).on("open.fndtn.reveal",".reveal-modal",this.settings.open).on("opened.fndtn.reveal",".reveal-modal",this.settings.opened).on("opened.fndtn.reveal",".reveal-modal",this.open_video).on("close.fndtn.reveal",".reveal-modal",this.settings.close).on("closed.fndtn.reveal",".reveal-modal",this.settings.closed).on("closed.fndtn.reveal",".reveal-modal",this.close_video),!0},open:function(target){if(target)var modal=$("#"+target.data("reveal-id"));else var modal=$(this.scope);if(!modal.hasClass("open")){var open_modal=$(".reveal-modal.open");modal.data("css-top")===undefined&&modal.data("css-top",parseInt(modal.css("top"),10)).data("offset",this.cache_offset(modal)),modal.trigger("open"),1>open_modal.length&&this.toggle_bg(modal),this.hide(open_modal,this.settings.css.close),this.show(modal,this.settings.css.open)}},close:function(modal){var modal=modal||$(this.scope),open_modals=$(".reveal-modal.open");open_modals.length>0&&(this.locked=!0,modal.trigger("close"),this.toggle_bg(modal),this.hide(open_modals,this.settings.css.close))},close_targets:function(){var base="."+this.settings.dismissModalClass;return this.settings.closeOnBackgroundClick?base+", ."+this.settings.bgClass:base},toggle_bg:function(){0===$(".reveal-modal-bg").length&&(this.settings.bg=$("<div />",{"class":this.settings.bgClass}).appendTo("body")),this.settings.bg.filter(":visible").length>0?this.hide(this.settings.bg):this.show(this.settings.bg)},show:function(el,css){if(css){if(/pop/i.test(this.settings.animation)){css.top=$(window).scrollTop()-el.data("offset")+"px";var end_css={top:$(window).scrollTop()+el.data("css-top")+"px",opacity:1};return this.delay(function(){return el.css(css).animate(end_css,this.settings.animationSpeed,"linear",function(){this.locked=!1,el.trigger("opened")}.bind(this)).addClass("open")}.bind(this),this.settings.animationSpeed/2)}if(/fade/i.test(this.settings.animation)){var end_css={opacity:1};return this.delay(function(){return el.css(css).animate(end_css,this.settings.animationSpeed,"linear",function(){this.locked=!1,el.trigger("opened")}.bind(this)).addClass("open")}.bind(this),this.settings.animationSpeed/2)}return el.css(css).show().css({opacity:1}).addClass("open").trigger("opened")}return/fade/i.test(this.settings.animation)?el.fadeIn(this.settings.animationSpeed/2):el.show()},hide:function(el,css){if(css){if(/pop/i.test(this.settings.animation)){var end_css={top:-$(window).scrollTop()-el.data("offset")+"px",opacity:0};return this.delay(function(){return el.animate(end_css,this.settings.animationSpeed,"linear",function(){this.locked=!1,el.css(css).trigger("closed")}.bind(this)).removeClass("open")}.bind(this),this.settings.animationSpeed/2)}if(/fade/i.test(this.settings.animation)){var end_css={opacity:0};return this.delay(function(){return el.animate(end_css,this.settings.animationSpeed,"linear",function(){this.locked=!1,el.css(css).trigger("closed")}.bind(this)).removeClass("open")}.bind(this),this.settings.animationSpeed/2)}return el.hide().css(css).removeClass("open").trigger("closed")}return/fade/i.test(this.settings.animation)?el.fadeOut(this.settings.animationSpeed/2):el.hide()},close_video:function(){var video=$(this).find(".flex-video"),iframe=video.find("iframe");iframe.length>0&&(iframe.attr("data-src",iframe[0].src),iframe.attr("src","about:blank"),video.hide())},open_video:function(){var video=$(this).find(".flex-video"),iframe=video.find("iframe");if(iframe.length>0){var data_src=iframe.attr("data-src");"string"==typeof data_src&&(iframe[0].src=iframe.attr("data-src")),video.show()}},cache_offset:function(modal){var offset=modal.show().height()+parseInt(modal.css("top"),10);return modal.hide(),offset},off:function(){$(this.scope).off(".fndtn.reveal")}}})(Foundation.zj,this,this.document);